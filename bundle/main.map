{"version":3,"sources":["webpack:///backend.js","webpack:///webpack/bootstrap 3803b7dcc83709183956","webpack:///./src/main.ts","webpack:///./mail-key.local.ts","webpack:///./src/app.ts","webpack:///./src/emailer/email-manager.ts","webpack:///./src/endpoints/endpoints.ts","webpack:///./src/orm/config.ts","webpack:///./src/orm/store-manager.ts","webpack:///./src/orm/table-models/company.table-model.ts","webpack:///./src/orm/table-models/contact.table-model.ts","webpack:///./src/orm/table-models/note.table-model.ts","webpack:///./src/orm/table-models/quote-line.table-model.ts","webpack:///./src/orm/table-models/quote.table-model.ts","webpack:///./src/orm/table-models/user.table-model.ts","webpack:///external \"express\"","webpack:///external \"http\"","webpack:///external \"lodash\"","webpack:///external \"sendgrid\"","webpack:///external \"sequelize\"","webpack:///external \"socket.io\""],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","app_1","Server","bootstrap","MAIL_API_KEY","__extends","this","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","http","express","Socketio","store_manager_1","endpoints_1","email_manager_1","_super","_this","port","app","config","endPoints","server","createServer","console","log","listen","IO","crmStoreManager","CRMStoreManager","emailManager","EmailManager","on","socket","socketOnCompanies","socketOnQuotes","socketOnContacts","socketOnUsers","socketOnNotes","socketOnEmailer","Endpoints","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","verb","v","op","f","TypeError","_","y","t","label","ops","pop","trys","length","push","g","sent","throw","return","Symbol","iterator","SendGrid","mail_key_local_1","sendGrid","mail","sendQuoteEmail","template","sendTo","subject","fromEmail","toEmail","content","mailBody","sg","request","_a","Email","Content","Mail","emptyRequest","method","path","toJSON","API","emailer","payload","res","emit","catch","err","createNote","note","error","id","getNote","getNotes","notes","setNoteProp","response","destroyNote","getUser","user","setUserProps","createQuote","quote","getQuotes","quotes","getQuote","setQuoteProps","setQuoteLineProps","quoteLine","createQuoteLine","destroyQuote","destroyQuoteLine","createContact","contact","getContact","getContacts","contacts","setContactProps","deleteContact","getCompanies","companies","getCompany","prop","setCompanyProp","company","props","setCompanyProps","createCompany","deleteCompany","DB_CONFIG","username","password","database","host","dialect","pool","max","min","idle","storage","sequelizeStatic","config_1","company_table_model_1","user_table_model_1","contact_table_model_1","quote_line_table_model_1","quote_table_model_1","note_table_model_1","_dbConfig","dbConfig","modelsInit","User","userModel","sequelize","Company","companyModel","Contact","contactModel","Note","noteModel","Quote","quoteModel","QuoteLine","quoteLineModel","hasMany","belongsTo","foreignKey","allowNull","syncTable","sync","firstName","lastName","email","role","findById","userInstance","update","createTestUser","instance","companiesInstance","findAll","include","companyInstance","key","updatedCompanyInstance","destroy","where","contactsInstance","owner_id","company_id","contactInstance","assign","contact_id","noteInstance","quotesInstance","quoteInstance_find","merge","quote_id","DataTypes","sequlize","define","type","UUID","primaryKey","defaultValue","UUIDV4","STRING","addressOne","addressTwo","city","zip","phone","web","fax","misc","created_at","DATE","updated_at","deleted_at","freezeTableName","paranoid","underscored","position","title","text","weight","DOUBLE","isCentered","BOOLEAN","unit","cost","FLOAT","desc","passHash","ENUM","values","required","businessName","businessWeb","businessPhone","businessFax","require"],"mappings":"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","file":"backend.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 19);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar app_1 = __webpack_require__(2);\r\nfunction boot() {\r\n    app_1.Server.bootstrap();\r\n}\r\nboot();\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.MAIL_API_KEY = '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';\r\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar http = __webpack_require__(14);\r\nvar express = __webpack_require__(13);\r\nvar Socketio = __webpack_require__(18);\r\nvar store_manager_1 = __webpack_require__(6);\r\nvar endpoints_1 = __webpack_require__(4);\r\nvar email_manager_1 = __webpack_require__(3);\r\nvar Server = (function (_super) {\r\n    __extends(Server, _super);\r\n    function Server() {\r\n        var _this = _super.call(this) || this;\r\n        _this.port = 1729;\r\n        _this.app = express();\r\n        _this.config();\r\n        _this.endPoints();\r\n        return _this;\r\n    }\r\n    Server.bootstrap = function () {\r\n        return new Server();\r\n    };\r\n    ;\r\n    Server.prototype.config = function () {\r\n        this.server = http.createServer(this.app);\r\n        console.log('listening on port ' + this.port);\r\n        this.server.listen(this.port);\r\n        this.IO = Socketio(this.server);\r\n        this.crmStoreManager = new store_manager_1.CRMStoreManager();\r\n        this.emailManager = new email_manager_1.EmailManager();\r\n    };\r\n    Server.prototype.endPoints = function () {\r\n        var _this = this;\r\n        this.IO.on('connection', function (socket) {\r\n            _this.socketOnCompanies(socket, _this.crmStoreManager);\r\n            _this.socketOnQuotes(socket, _this.crmStoreManager);\r\n            _this.socketOnContacts(socket, _this.crmStoreManager);\r\n            _this.socketOnUsers(socket, _this.crmStoreManager);\r\n            _this.socketOnNotes(socket, _this.crmStoreManager);\r\n            _this.socketOnEmailer(socket, _this.emailManager);\r\n        });\r\n    };\r\n    return Server;\r\n}(endpoints_1.Endpoints));\r\nexports.Server = Server;\r\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SendGrid = __webpack_require__(16);\r\nvar mail_key_local_1 = __webpack_require__(1);\r\nvar EmailManager = (function () {\r\n    function EmailManager() {\r\n        this.sendGrid = SendGrid;\r\n        this.mail = SendGrid.mail;\r\n    }\r\n    EmailManager.prototype.sendQuoteEmail = function (template, sendTo, subject) {\r\n        if (subject === void 0) { subject = 'Sending from AngularBros is Fun'; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var fromEmail, toEmail, content, mailBody, sg, request;\r\n            return __generator(this, function (_a) {\r\n                fromEmail = new this.mail.Email('AngularBros@example.com');\r\n                toEmail = new this.mail.Email(sendTo);\r\n                content = new this.mail.Content('text/html', template);\r\n                mailBody = new this.mail.Mail(fromEmail, subject, toEmail, content);\r\n                sg = this.sendGrid(mail_key_local_1.MAIL_API_KEY);\r\n                request = sg.emptyRequest({\r\n                    method: 'POST',\r\n                    path: '/v3/mail/send',\r\n                    body: mailBody.toJSON(),\r\n                });\r\n                return [2 /*return*/, sg.API(request)];\r\n            });\r\n        });\r\n    };\r\n    return EmailManager;\r\n}());\r\nexports.EmailManager = EmailManager;\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n//TODO Update endpoint's pattern. ;P\r\nvar Endpoints = (function () {\r\n    function Endpoints() {\r\n    }\r\n    Endpoints.prototype.socketOnEmailer = function (socket, emailer) {\r\n        socket.on('email.quote', function (payload) {\r\n            console.log(payload);\r\n            emailer.sendQuoteEmail(payload.template, payload.sendTo, payload.subject)\r\n                .then(function (res) {\r\n                socket.emit('email.quote.response', res);\r\n            })\r\n                .catch(function (err) {\r\n                socket.emit('email.quote.response', err);\r\n            });\r\n        });\r\n    };\r\n    Endpoints.prototype.socketOnNotes = function (socket, crmStoreManager) {\r\n        socket.on('note.create', function (payload) {\r\n            console.log('NoteCreated', payload);\r\n            if (payload) {\r\n                crmStoreManager.createNote(payload)\r\n                    .then(function (note) {\r\n                    socket.emit('note.create.response', note);\r\n                });\r\n            }\r\n            else {\r\n                socket.emit('note.create.response', { error: 'Cannot create without payload.' });\r\n            }\r\n        });\r\n        socket.on('notes.get', function (payload) {\r\n            if (payload && typeof payload.id === 'string') {\r\n                crmStoreManager.getNote(payload)\r\n                    .then(function (note) {\r\n                    socket.emit('notes.get.response', note);\r\n                });\r\n            }\r\n            else {\r\n                console.log('get notes', payload);\r\n                crmStoreManager.getNotes(payload)\r\n                    .then(function (notes) {\r\n                    socket.emit('notes.get.response', notes);\r\n                });\r\n            }\r\n        });\r\n        socket.on('note.set', function (payload) {\r\n            crmStoreManager.setNoteProp(payload)\r\n                .then(function (response) {\r\n                socket.emit('note.set.response', response);\r\n            });\r\n        });\r\n        socket.on('note.destroy', function (payload) {\r\n            crmStoreManager.destroyNote(payload)\r\n                .then(function (response) {\r\n                socket.emit('note.destroy.response', response);\r\n            });\r\n        });\r\n    };\r\n    Endpoints.prototype.socketOnUsers = function (socket, crmStoreManager) {\r\n        socket.on('user.get', function (payload) {\r\n            if (payload && typeof payload.id === 'string') {\r\n                crmStoreManager.getUser(payload)\r\n                    .then(function (user) {\r\n                    socket.emit('user.get.response', user);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n            else {\r\n                socket.emit('user.get.response', { error: 'No ID in payload' });\r\n            }\r\n        });\r\n        socket.on('user.set', function (payload) {\r\n            console.log('user.set.response', payload);\r\n            crmStoreManager.setUserProps(payload)\r\n                .then(function (response) {\r\n                socket.emit('user.set.response', response);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n    };\r\n    Endpoints.prototype.socketOnQuotes = function (socket, crmStoreManager) {\r\n        socket.on('quote.create', function (payload) {\r\n            if (payload) {\r\n                crmStoreManager.createQuote(payload)\r\n                    .then(function (quote) {\r\n                    socket.emit('quote.create.response', quote);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n        });\r\n        socket.on('quotes.get', function (payload) {\r\n            crmStoreManager.getQuotes(payload)\r\n                .then(function (quotes) {\r\n                socket.emit('quotes.get.response', quotes);\r\n            });\r\n        });\r\n        socket.on('quote.get', function (payload) {\r\n            crmStoreManager.getQuote(payload)\r\n                .then(function (quotes) {\r\n                socket.emit('quote.get.response', quotes);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n        socket.on('quote.set', function (payload) {\r\n            crmStoreManager.setQuoteProps(payload)\r\n                .then(function (quotes) {\r\n                socket.emit('quote.set.response', quotes);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n        socket.on('quoteLine.set', function (payload) {\r\n            crmStoreManager.setQuoteLineProps(payload)\r\n                .then(function (quoteLine) {\r\n                socket.emit('quoteLine.set.response', quoteLine);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n        socket.on('quoteLine.create', function (payload) {\r\n            crmStoreManager.createQuoteLine(payload)\r\n                .then(function (res) {\r\n                socket.emit('quoteLine.create.response', res);\r\n            });\r\n        });\r\n        socket.on('quote.destroy', function (payload) {\r\n            crmStoreManager.destroyQuote(payload)\r\n                .then(function (res) {\r\n                socket.emit('quote.destroy.response', res);\r\n            });\r\n        });\r\n        socket.on('quoteLine.destroy', function (payload) {\r\n            crmStoreManager.destroyQuoteLine(payload)\r\n                .then(function (res) {\r\n                socket.emit('quoteLine.destroy.response', res);\r\n            });\r\n        });\r\n    };\r\n    Endpoints.prototype.socketOnContacts = function (socket, crmStoreManager) {\r\n        socket.on('contact.create', function (payload) {\r\n            if (payload) {\r\n                crmStoreManager.createContact(payload).then(function (contact) {\r\n                    socket.emit('contact.create.response', contact);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n        });\r\n        socket.on('contacts.get', function (payload) {\r\n            if (payload && typeof payload.id === 'string') {\r\n                crmStoreManager.getContact(payload)\r\n                    .then(function (contact) {\r\n                    socket.emit('contacts.get.response', contact);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n            else {\r\n                crmStoreManager.getContacts(payload)\r\n                    .then(function (contacts) {\r\n                    socket.emit('contacts.get.response', contacts);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n        });\r\n        socket.on('contact.set', function (payload) {\r\n            if (payload && typeof payload.id === 'string')\r\n                crmStoreManager.setContactProps(payload)\r\n                    .then(function (contact) {\r\n                    socket.emit('contact.set.response', contact);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n        });\r\n        socket.on('contact.destroy', function (payload) {\r\n            crmStoreManager.deleteContact(payload).then(function (res) {\r\n                socket.emit('contact.destroy.response', res);\r\n            });\r\n        });\r\n    };\r\n    Endpoints.prototype.socketOnCompanies = function (socket, crmStoreManager) {\r\n        socket.on('companies.get', function () {\r\n            crmStoreManager.getCompanies()\r\n                .then(function (companies) {\r\n                socket.emit('companies.get.response', companies);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n        socket.on('company.get', function (payload) {\r\n            crmStoreManager.getCompany(payload)\r\n                .then(function (companies) {\r\n                socket.emit('company.get.response', companies);\r\n            }, function (err) {\r\n                console.log('error', err);\r\n            });\r\n        });\r\n        socket.on('company.set', function (payload) {\r\n            if (payload.prop && typeof payload.id === 'string') {\r\n                crmStoreManager.setCompanyProp(payload)\r\n                    .then(function (company) {\r\n                    socket.emit('company.set.response', company);\r\n                }, function (err) {\r\n                    console.log('error', err);\r\n                });\r\n            }\r\n            else if (payload.props) {\r\n                crmStoreManager.setCompanyProps(payload)\r\n                    .then(function (company) {\r\n                    socket.emit('company.set.response', company);\r\n                });\r\n            }\r\n            else {\r\n                socket.emit('company.set.response', { error: 'Error: No payload or id' });\r\n            }\r\n        });\r\n        socket.on('company.create', function (payload) {\r\n            crmStoreManager\r\n                .createCompany(payload)\r\n                .then(function (company) {\r\n                socket.emit('company.create.response', company);\r\n            });\r\n        });\r\n        socket.on('company.delete', function (payload) {\r\n            crmStoreManager\r\n                .deleteCompany(payload)\r\n                .then(function (company) {\r\n                socket.emit('company.delete.response', company);\r\n            });\r\n        });\r\n    };\r\n    return Endpoints;\r\n}());\r\nexports.Endpoints = Endpoints;\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.DB_CONFIG = {\r\n    username: 'rdev',\r\n    password: '',\r\n    database: 'angular-bros-crm',\r\n    host: 'localhost',\r\n    dialect: 'sqlite',\r\n    pool: {\r\n        max: 5,\r\n        min: 0,\r\n        idle: 10000\r\n    },\r\n    storage: './rdev.sql3'\r\n};\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar sequelizeStatic = __webpack_require__(17);\r\nvar config_1 = __webpack_require__(5);\r\nvar company_table_model_1 = __webpack_require__(7);\r\nvar user_table_model_1 = __webpack_require__(12);\r\nvar contact_table_model_1 = __webpack_require__(8);\r\nvar quote_line_table_model_1 = __webpack_require__(10);\r\nvar quote_table_model_1 = __webpack_require__(11);\r\nvar note_table_model_1 = __webpack_require__(9);\r\nvar _ = __webpack_require__(15);\r\nvar CRMStoreManager = (function () {\r\n    function CRMStoreManager() {\r\n        this._dbConfig = config_1.DB_CONFIG;\r\n        this.dbConfig(this._dbConfig);\r\n        this.modelsInit();\r\n    }\r\n    CRMStoreManager.prototype.modelsInit = function () {\r\n        this.User = user_table_model_1.userModel(sequelizeStatic, this.sequelize);\r\n        this.Company = company_table_model_1.companyModel(sequelizeStatic, this.sequelize);\r\n        this.Contact = contact_table_model_1.contactModel(sequelizeStatic, this.sequelize);\r\n        this.Note = note_table_model_1.noteModel(sequelizeStatic, this.sequelize);\r\n        this.Quote = quote_table_model_1.quoteModel(sequelizeStatic, this.sequelize);\r\n        this.QuoteLine = quote_line_table_model_1.quoteLineModel(sequelizeStatic, this.sequelize);\r\n        this.User.hasMany(this.Company);\r\n        this.Contact.belongsTo(this.Company, { foreignKey: { allowNull: false } });\r\n        this.Contact.hasMany(this.Note);\r\n        this.Note.belongsTo(this.Contact, { foreignKey: { allowNull: false } });\r\n        this.Company.belongsTo(this.User);\r\n        this.Company.hasMany(this.Contact, { foreignKey: { allowNull: false } });\r\n        this.Company.hasMany(this.Quote);\r\n        this.Quote.belongsTo(this.Company);\r\n        this.Quote.hasMany(this.QuoteLine);\r\n        this.QuoteLine.belongsTo(this.Quote);\r\n    };\r\n    CRMStoreManager.prototype.dbConfig = function (config) {\r\n        this.sequelize = new sequelizeStatic(config.database, config.username, config.password, {\r\n            host: config.host,\r\n            dialect: config.dialect,\r\n            pool: {\r\n                max: config.pool.max,\r\n                min: config.pool.min,\r\n                idle: config.pool.idle\r\n            },\r\n            storage: config.storage\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.syncTable = function () {\r\n        var _this = this;\r\n        this.sequelize.sync().then(function () {\r\n            _this.User.create({\r\n                firstName: 'Test',\r\n                lastName: 'Tester',\r\n                email: 'test@tester.com',\r\n                role: 'admin'\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getUser = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.User.findById(payload.id)\r\n                .then(function (userInstance) {\r\n                console.log('user ', userInstance);\r\n                resolve(userInstance);\r\n                reject('error with find ID');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setUserProps = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.User.findById(payload.id)\r\n                .then(function (userInstance) {\r\n                userInstance.update(payload.props)\r\n                    .then(function (response) {\r\n                    resolve(response);\r\n                    console.log('user set', response);\r\n                }, function (error) {\r\n                    reject('update error with' + error);\r\n                }).catch(function (error) { return console.log(error); });\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createTestUser = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.sequelize.sync().then(function (instance) {\r\n                return instance.User.create({\r\n                    email: 'test@tester.com',\r\n                    role: 'general'\r\n                });\r\n            }).then(function (userInstance) {\r\n                resolve(userInstance);\r\n                reject('error with test user');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getCompany = function (payload) {\r\n        var _this = this;\r\n        if (payload) {\r\n            return new Promise(function (resolve, reject) {\r\n                _this.Company.findById(payload.id)\r\n                    .then(function (companiesInstance) {\r\n                    resolve(companiesInstance);\r\n                    reject('error with find ID');\r\n                });\r\n            });\r\n        }\r\n    };\r\n    CRMStoreManager.prototype.getCompanies = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Company.findAll({\r\n                include: [_this.Contact, _this.Quote,]\r\n            })\r\n                .then(function (companies) {\r\n                resolve(companies);\r\n                reject('error: no companies found');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setCompanyProp = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Company.findById(payload.id)\r\n                .then(function (companyInstance) {\r\n                companyInstance.update((_a = {}, _a[payload.prop.key] = payload.prop.value, _a))\r\n                    .then(function (updatedCompanyInstance) {\r\n                    resolve(updatedCompanyInstance);\r\n                }).catch(function (err) { return console.log('ERROR : setCompanyProp', err); });\r\n                var _a;\r\n            }, function (error) { return reject('Company set prop error :' + error); });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setCompanyProps = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Company.findById(payload.id)\r\n                .then(function (companyInstance) {\r\n                companyInstance.update(payload.props)\r\n                    .then(function (updatedCompanyInstance) {\r\n                    resolve(updatedCompanyInstance);\r\n                }).catch(function (err) { return console.log('ERROR : setCompanyProp', err); });\r\n            }, function (error) { return reject('Company set prop error :' + error); });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createCompany = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Company.create(payload.props, {\r\n                include: [_this.Quote, _this.Contact]\r\n            }).then(function (companyInstance) {\r\n                resolve(companyInstance);\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.deleteCompany = function (payload) {\r\n        var _this = this;\r\n        console.log('payload', payload);\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Company.destroy({ where: { id: payload.id } }).then(function (res) {\r\n                resolve(res);\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.deleteContact = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.Contact.destroy({ where: { id: payload.id } }).then(function (res) {\r\n                resolve(res);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getContact = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Contact.findById(payload.id, { include: [_this.Note] })\r\n                .then(function (contactsInstance) {\r\n                console.log('Contact instance ', contactsInstance);\r\n                resolve(contactsInstance);\r\n                reject('error with find ID');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getContacts = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (payload.owner_id) {\r\n                _this.Contact.findAll({ where: { company_id: payload.owner_id }, include: [_this.Note] })\r\n                    .then(function (contactsInstance) {\r\n                    console.log('CONTACTS INSTANCE', contactsInstance);\r\n                    resolve(contactsInstance);\r\n                });\r\n            }\r\n            else {\r\n                _this.Contact.findAll({ include: [_this.Note] })\r\n                    .then(function (contactsInstance) {\r\n                    console.log('CONTACTS INSTANCE', contactsInstance);\r\n                    resolve(contactsInstance);\r\n                }, function (error) { return reject('error finding Contacts: ' + error); });\r\n            }\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setContactProps = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Contact.findById(payload.id)\r\n                .then(function (contactInstance) {\r\n                contactInstance.update(payload.props)\r\n                    .then(function (instance) {\r\n                    resolve(instance);\r\n                });\r\n            }, function (error) {\r\n                reject('update error with: ' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createContact = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var props = Object.assign({}, payload.props, { company_id: payload.owner_id });\r\n            _this.Contact.create(props).then(function (instance) {\r\n                resolve(instance);\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getNote = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Note.findById(payload.id).then(function (notes) {\r\n                resolve(notes);\r\n                reject('error: no notes found');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getNotes = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Note.findAll({ where: { contact_id: payload.owner_id } })\r\n                .then(function (notes) {\r\n                resolve(notes);\r\n                reject('error: no notes found');\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setNoteProp = function (payload) {\r\n        var _this = this;\r\n        console.log('notes payload', payload);\r\n        return new Promise(function (resolve) {\r\n            _this.Note.findById(payload.id).then(function (noteInstance) {\r\n                noteInstance.update((_a = {}, _a[payload.prop.key] = payload.prop.value, _a))\r\n                    .then(function (response) {\r\n                    console.log('updated note with resposne: ', response);\r\n                    resolve(response);\r\n                });\r\n                var _a;\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createNote = function (payload) {\r\n        var _this = this;\r\n        var props = Object.assign({}, { contact_id: payload.owner_id });\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Note.create(props).then(function (instance) {\r\n                resolve(instance);\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.destroyNote = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.Note.destroy({ where: { id: payload.id } }).then(function (res) {\r\n                resolve(res);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getQuote = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Quote.findById(payload.id, {\r\n                include: [\r\n                    _this.QuoteLine\r\n                ]\r\n            }).then(function (quotesInstance) {\r\n                resolve(quotesInstance);\r\n            }, function (error) { return reject('error with find ID'); });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.getQuotes = function (payload) {\r\n        var _this = this;\r\n        if (payload.owner_id) {\r\n            return new Promise(function (resolve, reject) {\r\n                _this.Quote.findAll({\r\n                    include: [\r\n                        _this.QuoteLine\r\n                    ],\r\n                    where: {\r\n                        company_id: payload.owner_id\r\n                    }\r\n                }).then(function (quotesInstance) {\r\n                    resolve(quotesInstance);\r\n                }, function (error) { return reject('error with find ID'); });\r\n            });\r\n        }\r\n        else {\r\n            return new Promise(function (resolve, reject) {\r\n                _this.Quote.findAll({\r\n                    include: [_this.QuoteLine]\r\n                }).then(function (quotesInstance) {\r\n                    resolve(quotesInstance);\r\n                }, function (error) { return reject('error with find ID'); });\r\n            });\r\n        }\r\n    };\r\n    CRMStoreManager.prototype.setQuoteProps = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Quote.update(payload.props, {\r\n                where: { id: payload.id }\r\n            }).then(function (response) {\r\n                if (+response[0] === 1)\r\n                    _this.Quote.findById(payload.id, {\r\n                        include: [_this.QuoteLine]\r\n                    })\r\n                        .then(function (quoteInstance_find) {\r\n                        resolve(quoteInstance_find);\r\n                    });\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.setQuoteLineProps = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.QuoteLine.update(payload.props, { where: { id: payload.id } })\r\n                .then(function (response) {\r\n                resolve(response);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createQuote = function (payload) {\r\n        var _this = this;\r\n        var props = Object.assign({}, payload.props, { company_id: payload.owner_id });\r\n        return new Promise(function (resolve, reject) {\r\n            _this.Quote.create(props).then(function (instance) {\r\n                resolve(instance);\r\n            }, function (error) {\r\n                reject('update error with' + error);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.createQuoteLine = function (payload) {\r\n        var _this = this;\r\n        var props = _.merge({}, payload.props, { quote_id: payload.owner_id });\r\n        return new Promise(function (resolve) {\r\n            _this.QuoteLine.create(props).then(function (res) {\r\n                resolve(res);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.destroyQuote = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.Quote.destroy({ where: { id: payload.id } }).then(function (res) {\r\n                resolve(res);\r\n            });\r\n        });\r\n    };\r\n    CRMStoreManager.prototype.destroyQuoteLine = function (payload) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            _this.QuoteLine.destroy({ where: { id: payload.id } }).then(function (res) {\r\n                resolve(res);\r\n            });\r\n        });\r\n    };\r\n    return CRMStoreManager;\r\n}());\r\nexports.CRMStoreManager = CRMStoreManager;\r\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction companyModel(DataTypes, sequlize) {\r\n    return sequlize.define('company', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        addressOne: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        addressTwo: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        city: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        zip: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        phone: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        web: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        fax: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        misc: {\r\n            type: DataTypes.STRING\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true\r\n    });\r\n}\r\nexports.companyModel = companyModel;\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction contactModel(DataTypes, sequlize) {\r\n    return sequlize.define('contact', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING\r\n            // required: true\r\n        },\r\n        phone: {\r\n            type: DataTypes.STRING\r\n        },\r\n        email: {\r\n            type: DataTypes.STRING\r\n        },\r\n        position: {\r\n            type: DataTypes.STRING\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true\r\n    });\r\n}\r\nexports.contactModel = contactModel;\r\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction noteModel(DataTypes, sequlize) {\r\n    return sequlize.define('note', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        title: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        text: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true\r\n    });\r\n}\r\nexports.noteModel = noteModel;\r\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction quoteLineModel(DataTypes, sequlize) {\r\n    return sequlize.define('quoteLine', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING\r\n        },\r\n        weight: {\r\n            type: DataTypes.DOUBLE\r\n        },\r\n        isCentered: {\r\n            type: DataTypes.BOOLEAN\r\n        },\r\n        unit: {\r\n            type: DataTypes.STRING\r\n        },\r\n        cost: {\r\n            type: DataTypes.FLOAT\r\n        },\r\n        desc: {\r\n            type: DataTypes.STRING\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true\r\n    });\r\n}\r\nexports.quoteLineModel = quoteLineModel;\r\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction quoteModel(DataTypes, sequlize) {\r\n    return sequlize.define('quote', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        name: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true,\r\n    });\r\n}\r\nexports.quoteModel = quoteModel;\r\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction userModel(DataTypes, sequlize) {\r\n    return sequlize.define('user', {\r\n        id: {\r\n            type: DataTypes.UUID,\r\n            primaryKey: true,\r\n            defaultValue: DataTypes.UUIDV4\r\n        },\r\n        firstName: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        lastName: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        passHash: {\r\n            type: DataTypes.STRING,\r\n        },\r\n        role: {\r\n            type: DataTypes.ENUM,\r\n            values: ['general', 'blocked', 'admin', 'removed'],\r\n            required: true\r\n        },\r\n        email: {\r\n            type: DataTypes.STRING,\r\n            required: true\r\n        },\r\n        addressOne: {\r\n            type: DataTypes.STRING\r\n        },\r\n        addressTwo: {\r\n            type: DataTypes.STRING\r\n        },\r\n        phone: {\r\n            type: DataTypes.STRING\r\n        },\r\n        businessName: {\r\n            type: DataTypes.STRING\r\n        },\r\n        businessWeb: {\r\n            type: DataTypes.STRING\r\n        },\r\n        businessPhone: {\r\n            type: DataTypes.STRING\r\n        },\r\n        businessFax: {\r\n            type: DataTypes.STRING\r\n        },\r\n        created_at: {\r\n            type: DataTypes.DATE,\r\n            allowNull: false\r\n        },\r\n        updated_at: DataTypes.DATE,\r\n        deleted_at: DataTypes.DATE\r\n    }, {\r\n        freezeTableName: true,\r\n        paranoid: false,\r\n        underscored: true,\r\n    });\r\n}\r\nexports.userModel = userModel;\r\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"express\");\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"http\");\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"lodash\");\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"sendgrid\");\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"sequelize\");\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"socket.io\");\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(0);\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// backend.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3803b7dcc83709183956","import {Server} from './app';\n\nfunction boot() {\n\tServer.bootstrap();\n}\n\nboot();\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","export const MAIL_API_KEY = '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';\n\n\n// WEBPACK FOOTER //\n// ./mail-key.local.ts","import * as http from 'http';\nimport * as express from 'express';\nimport * as Socketio from 'socket.io';\nimport {CRMStoreManager} from './orm/store-manager';\nimport {Endpoints} from './endpoints/endpoints';\nimport {EmailManager} from './emailer/email-manager';\n\n\nexport class Server extends Endpoints {\n\tpublic emailManager: EmailManager;\n\tprivate app: express.Application;\n\tprivate server: express.Server;\n\tprivate IO;\n\tprivate port: number = 1729;\n\tprivate crmStoreManager: CRMStoreManager;\n\n\tpublic static bootstrap(): Server {\n\t\treturn new Server();\n\t}\n\n\tconstructor(){\n\t\tsuper();\n\t\tthis.app = express();\n\t\tthis.config();\n\t\tthis.endPoints();\n\t};\n\n\tprivate config(): void {\n\t\tthis.server = http.createServer(this.app);\n\t\tconsole.log('listening on port ' + this.port);\n\t\tthis.server.listen(this.port);\n\t\tthis.IO = Socketio(this.server);\n\t\tthis.crmStoreManager = new CRMStoreManager();\n\t\tthis.emailManager = new EmailManager();\n\t}\n\n\tprivate endPoints(): void {\n\t\tthis.IO.on('connection', socket => {\n\t\t\tthis.socketOnCompanies(socket, this.crmStoreManager);\n\t\t\tthis.socketOnQuotes(socket, this.crmStoreManager);\n\t\t\tthis.socketOnContacts(socket, this.crmStoreManager);\n\t\t\tthis.socketOnUsers(socket, this.crmStoreManager);\n\t\t\tthis.socketOnNotes(socket, this.crmStoreManager);\n\t\t\tthis.socketOnEmailer(socket, this.emailManager)\n\t\t})\n\t}\n}\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.ts","import * as SendGrid from 'sendgrid';\nimport {MAIL_API_KEY} from '../../mail-key.local'\n\nexport class EmailManager {\n\tpublic sendGrid = SendGrid;\n\tpublic mail = SendGrid.mail;\n\tconstructor(){\n\t}\n\n\tpublic async sendQuoteEmail(template, sendTo, subject = 'Sending from AngularBros is Fun'): Promise<any> {\n\t\tlet fromEmail = new this.mail.Email('AngularBros@example.com');\n\t\tlet toEmail = new this.mail.Email(sendTo);\n\t\tlet content = new this.mail.Content('text/html', template);\n\t\tlet mailBody = new this.mail.Mail(fromEmail, subject, toEmail, content);\n\t\tlet sg = this.sendGrid(MAIL_API_KEY);\n\t\tlet request = sg.emptyRequest({\n\t\t\tmethod: 'POST',\n\t\t\tpath: '/v3/mail/send',\n\t\t\tbody: mailBody.toJSON(),\n\t\t});\n\n\t\treturn sg.API(request)\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/emailer/email-manager.ts","import {CRMStoreManager} from '../orm/store-manager';\nimport * as SocketIO from 'socket.io';\nimport {error} from 'util';\nimport {QuoteAttributes} from '../orm/table-models/attributes/quote.attributes';\nimport {EmailManager} from '../emailer/email-manager';\n\n//TODO Update endpoint's pattern. ;P\nexport class Endpoints {\n\tconstructor() {}\n\n\tpublic socketOnEmailer(socket: SocketIO, emailer: EmailManager): void {\n\t\tsocket.on('email.quote', (payload: any) => {\n\t\tconsole.log(payload);\n\t\t\temailer.sendQuoteEmail(payload.template, payload.sendTo, payload.subject)\n\t\t\t\t.then( res => {\n\t\t\t\t\tsocket.emit('email.quote.response', res);\n\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tsocket.emit('email.quote.response', err);\n\t\t\t\t})\n\t\t})\n\t}\n\n\tpublic socketOnNotes(socket: SocketIO, crmStoreManager: CRMStoreManager): void {\n\t\tsocket.on('note.create', (payload: any) => {\n\t\t\tconsole.log('NoteCreated', payload);\n\t\t\tif (payload){\n\t\t\t\tcrmStoreManager.createNote(payload)\n\t\t\t\t\t.then(note => {\n\t\t\t\t\t\tsocket.emit('note.create.response', note);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsocket.emit('note.create.response', {error: 'Cannot create without payload.'});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('notes.get', (payload?: any) => {\n\t\t\tif (payload && typeof payload.id === 'string') {\n\t\t\t\tcrmStoreManager.getNote(payload)\n\t\t\t\t\t.then(note => {\n\t\t\t\t\t\tsocket.emit('notes.get.response', note);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.log('get notes', payload);\n\t\t\t\tcrmStoreManager.getNotes(payload)\n\t\t\t\t\t.then(notes => {\n\t\t\t\t\t\tsocket.emit('notes.get.response', notes);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('note.set', (payload: any) => {\n\t\t\tcrmStoreManager.setNoteProp(payload)\n\t\t\t\t.then(response => {\n\t\t\t\t\tsocket.emit('note.set.response', response);\n\t\t\t\t});\n\t\t});\n\n\t\tsocket.on('note.destroy', (payload: any) => {\n\t\t\tcrmStoreManager.destroyNote(payload)\n\t\t\t\t.then(response => {\n\t\t\t\t\tsocket.emit('note.destroy.response', response);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tpublic socketOnUsers(socket: SocketIO, crmStoreManager: CRMStoreManager){\n\t\tsocket.on('user.get', (payload?: any) => {\n\t\t\tif (payload && typeof payload.id === 'string') {\n\t\t\t\tcrmStoreManager.getUser(payload)\n\t\t\t\t\t.then(user => {\n\t\t\t\t\t\tsocket.emit('user.get.response', user);\n\t\t\t\t\t}, err => {\n\t\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsocket.emit('user.get.response', {error: 'No ID in payload'})\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('user.set', (payload: any) => {\n\t\t\t\t\tconsole.log('user.set.response', payload);\n\t\t\tcrmStoreManager.setUserProps(payload)\n\t\t\t\t.then(response => {\n\t\t\t\t\tsocket.emit('user.set.response', response);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t})\n\t}\n\n\tpublic socketOnQuotes(socket: SocketIO , crmStoreManager: CRMStoreManager) {\n\t\tsocket.on('quote.create', (payload: any) => {\n\t\t\tif (payload){\n\t\t\t\tcrmStoreManager.createQuote(payload)\n\t\t\t\t\t.then((quote: QuoteAttributes) => {\n\t\t\t\t\t\tsocket.emit('quote.create.response', quote);\n\t\t\t\t\t}, err => {\n\t\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\n\t\tsocket.on('quotes.get', (payload?: any) => {\n\t\t\tcrmStoreManager.getQuotes(payload)\n\t\t\t\t.then((quotes: QuoteAttributes[]) => {\n\t\t\t\t\tsocket.emit('quotes.get.response', quotes);\n\t\t\t})\n\t\t});\n\n\t\tsocket.on('quote.get', (payload?: any) => {\n\t\t\tcrmStoreManager.getQuote(payload)\n\t\t\t\t.then(quotes => {\n\t\t\t\t\tsocket.emit('quote.get.response', quotes);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t});\n\t\t});\n\n\t\tsocket.on('quote.set', (payload: any) => {\n\t\t\tcrmStoreManager.setQuoteProps(payload)\n\t\t\t\t.then(quotes => {\n\t\t\t\t\tsocket.emit('quote.set.response', quotes);\n\t\t\t}, err => {\n\t\t\t\tconsole.log('error', err)\n\t\t\t})\n\t\t});\n\n\t\tsocket.on('quoteLine.set', (payload: any) => {\n\t\t\tcrmStoreManager.setQuoteLineProps(payload)\n\t\t\t\t.then(quoteLine => {\n\t\t\t\t\tsocket.emit('quoteLine.set.response', quoteLine);\n\t\t\t}, err => {\n\t\t\t\tconsole.log('error', err)\n\t\t\t})\n\t\t});\n\n\t\tsocket.on('quoteLine.create', (payload: any) => {\n\t\t\tcrmStoreManager.createQuoteLine(payload)\n\t\t\t\t.then(res => {\n\t\t\t\t\tsocket.emit('quoteLine.create.response', res);\n\t\t\t\t})\n\t\t});\n\n\t\tsocket.on('quote.destroy', (payload: any) => {\n\t\t\tcrmStoreManager.destroyQuote(payload)\n\t\t\t\t.then(res => {\n\t\t\t\t\tsocket.emit('quote.destroy.response', res);\n\t\t\t\t})\n\t\t});\n\n\t\tsocket.on('quoteLine.destroy', (payload: any) => {\n\t\t\tcrmStoreManager.destroyQuoteLine(payload)\n\t\t\t\t.then(res => {\n\t\t\t\t\tsocket.emit('quoteLine.destroy.response', res);\n\t\t\t\t})\n\t\t});\n\n\n\t}\n\n\tpublic socketOnContacts(socket: SocketIO, crmStoreManager: CRMStoreManager) {\n\t\tsocket.on('contact.create', (payload?: any) => {\n\t\t\tif(payload) {\n\t\t\t\tcrmStoreManager.createContact(payload).then(contact => {\n\t\t\t\t\tsocket.emit('contact.create.response', contact);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('contacts.get', (payload?: any) => {\n\t\t\tif (payload && typeof payload.id === 'string'){\n\t\t\t\tcrmStoreManager.getContact(payload)\n\t\t\t\t\t.then(contact => {\n\t\t\t\t\t\tsocket.emit('contacts.get.response', contact);\n\t\t\t\t\t}, err => {\n\t\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcrmStoreManager.getContacts(payload)\n\t\t\t\t\t.then(contacts => {\n\t\t\t\t\t\tsocket.emit('contacts.get.response', contacts);\n\t\t\t\t}, err => {\n\t\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('contact.set', (payload: any) => {\n\t\t\tif(payload && typeof payload.id === 'string')\n\t\t\t\tcrmStoreManager.setContactProps(payload)\n\t\t\t\t.then(contact => {\n\t\t\t\t\tsocket.emit('contact.set.response', contact);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t});\n\n\t\tsocket.on('contact.destroy', (payload: any) => {\n\t\t\tcrmStoreManager.deleteContact(payload).then(res => {\n\t\t\t\tsocket.emit('contact.destroy.response', res);\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic socketOnCompanies(socket: SocketIO, crmStoreManager: CRMStoreManager) {\n\t\tsocket.on('companies.get', () => {\n\t\t\tcrmStoreManager.getCompanies()\n\t\t\t\t.then((companies: any) => {\n\t\t\t\t\tsocket.emit('companies.get.response', companies);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t});\n\n\t\tsocket.on('company.get', (payload) => {\n\t\t\tcrmStoreManager.getCompany(payload)\n\t\t\t\t.then((companies: any) => {\n\t\t\t\t\tsocket.emit('company.get.response', companies);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t});\n\n\t\tsocket.on('company.set', (payload: any) => {\n\t\t\tif (payload.prop && typeof payload.id === 'string') {\n\t\t\t\tcrmStoreManager.setCompanyProp(payload)\n\t\t\t\t.then(company => {\n\t\t\t\t\tsocket.emit('company.set.response', company);\n\t\t\t\t}, err => {\n\t\t\t\t\tconsole.log('error', err)\n\t\t\t\t});\n\t\t\t} else if(payload.props){\n\t\t\t\tcrmStoreManager.setCompanyProps(payload)\n\t\t\t\t\t.then(company => {\n\t\t\t\t\t\tsocket.emit('company.set.response', company);\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tsocket.emit('company.set.response', {error: 'Error: No payload or id'});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on('company.create', (payload?: any) => {\n\t\t\tcrmStoreManager\n\t\t\t\t.createCompany(payload)\n\t\t\t\t.then(company => {\n\t\t\t\t\tsocket.emit('company.create.response', company);\n\t\t\t\t});\n\t\t});\n\n\t\tsocket.on('company.delete', (payload?: any) => {\n\t\t\tcrmStoreManager\n\t\t\t\t.deleteCompany(payload)\n\t\t\t\t.then(company => {\n\t\t\t\t\tsocket.emit('company.delete.response', company);\n\t\t\t\t});\n\t\t});\n\t}\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/endpoints/endpoints.ts","export interface DBConfig {\n\tusername: string;\n\tpassword: string;\n\tdatabase: string;\n\thost: string;\n\tdialect: string;\n\tpool: {\n\t\tmax: number,\n\t\tmin: number,\n\t\tidle: number\n\t}\n\tstorage: string;\n}\n\nexport const DB_CONFIG = {\n\tusername: 'rdev',\n\tpassword: '',\n\tdatabase: 'angular-bros-crm',\n\thost: 'localhost',\n\tdialect: 'sqlite',\n\tpool: {\n\t\tmax: 5,\n\t\tmin: 0,\n\t\tidle: 10000\n\t},\n\tstorage: './rdev.sql3'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/orm/config.ts","import * as sequelizeStatic from 'sequelize';\nimport {DBConfig, DB_CONFIG} from './config';\nimport {UserAttributes, UserInstance, UserModel} from './table-models/attributes/user.attributes';\nimport {CompanyAttributes, CompanyInstance, CompanyModel} from './table-models/attributes/company.attributes';\nimport {ContactAttributes, ContactInstance, ContactModel} from './table-models/attributes/contact.attributes';\nimport {NoteAttributes, NoteInstance, NoteModel} from './table-models/attributes/note.attributes';\nimport {QuoteAttributes, QuoteInstance, QuoteModel} from './table-models/attributes/quote.attributes';\nimport {QuoteLineModel} from './table-models/attributes/quote-line.attributes';\nimport {companyModel} from './table-models/company.table-model';\nimport {userModel} from './table-models/user.table-model';\nimport {contactModel} from './table-models/contact.table-model';\nimport {quoteLineModel} from './table-models/quote-line.table-model';\nimport {quoteModel} from './table-models/quote.table-model';\nimport {noteModel} from './table-models/note.table-model';\nimport * as _ from 'lodash';\n\nexport interface StoreManager {\n\tdeleteCompany(payload): Promise<string>;\n\tgetUser(payload): Promise<UserAttributes>;\n\tsetUserProps(payload): Promise<UserAttributes>;\n\tcreateTestUser(): Promise<UserAttributes>;\n\tgetCompany(payload: any): Promise<CompanyAttributes[]>;\n\tsetCompanyProp(payload: any): Promise<CompanyAttributes>;\n\tsetCompanyProps(payload): Promise<CompanyAttributes>;\n\tcreateCompany(payload: any): Promise<CompanyAttributes>;\n\tgetContact(payload: any): Promise<ContactAttributes>;\n\tgetContacts(payload: any): Promise<ContactAttributes[]>;\n\tsetContactProps(payload: any): Promise<ContactAttributes>;\n\tcreateContact(payload: any): Promise<ContactAttributes>;\n\tdeleteContact(payload: any): Promise<any>;\n\tgetNote(payload: any): Promise<NoteAttributes>\n\tgetNotes(payload): Promise<NoteAttributes[]>;\n\tsetNoteProp(payload: any): Promise<NoteAttributes>;\n\tcreateNote(payload: any): Promise<NoteAttributes>;\n\tdestroyNote(payload): Promise<any>;\n\tgetQuotes(payload: any): Promise<QuoteAttributes[]>;\n\tgetQuote(payload: any): Promise<QuoteAttributes>;\n\tsetQuoteProps(payload): Promise<QuoteAttributes>;\n\tcreateQuote(payload: any): Promise<QuoteAttributes>;\n\tcreateQuoteLine(quoteId, quoteLine): Promise<any>;\n\tsetQuoteLineProps(payload: any): Promise<QuoteAttributes>;\n\tdestroyQuoteLine (payload): Promise<any>;\n}\n\nexport class CRMStoreManager implements StoreManager{\n\tpublic sequelize: sequelizeStatic.Sequelize;\n\tpublic User: UserModel;\n\tpublic Company: CompanyModel;\n\tpublic Contact: ContactModel;\n\tpublic Note: NoteModel;\n\tpublic Quote: QuoteModel;\n\tpublic QuoteLine: QuoteLineModel;\n\tprivate _dbConfig: DBConfig = DB_CONFIG;\n\n\tconstructor() {\n\t\tthis.dbConfig(this._dbConfig);\n\t\tthis.modelsInit();\n\t}\n\n\tprivate modelsInit(): void {\n\t\tthis.User = userModel(sequelizeStatic, this.sequelize);\n\t\tthis.Company = companyModel(sequelizeStatic, this.sequelize);\n\t\tthis.Contact = contactModel(sequelizeStatic, this.sequelize);\n\t\tthis.Note = noteModel(sequelizeStatic, this.sequelize);\n\t\tthis.Quote = quoteModel(sequelizeStatic, this.sequelize);\n\t\tthis.QuoteLine = quoteLineModel(sequelizeStatic, this.sequelize);\n\t\tthis.User.hasMany(this.Company);\n\t\tthis.Contact.belongsTo(this.Company, {foreignKey: {allowNull: false}});\n\t\tthis.Contact.hasMany(this.Note);\n\t\tthis.Note.belongsTo(this.Contact, {foreignKey: {allowNull: false}});\n\t\tthis.Company.belongsTo(this.User);\n\t\tthis.Company.hasMany(this.Contact,{foreignKey: {allowNull: false}});\n\t\tthis.Company.hasMany(this.Quote);\n\t\tthis.Quote.belongsTo(this.Company);\n\t\tthis.Quote.hasMany(this.QuoteLine);\n\t\tthis.QuoteLine.belongsTo(this.Quote);\n\t}\n\n\tprivate dbConfig(config): void {\n\t\tthis.sequelize = new sequelizeStatic(config.database, config.username, config.password, {\n\t\t\thost: config.host,\n\t\t\tdialect: config.dialect,\n\t\t\tpool: {\n\t\t\t\tmax: config.pool.max,\n\t\t\t\tmin: config.pool.min,\n\t\t\t\tidle: config.pool.idle\n\t\t\t},\n\t\t\tstorage: config.storage\n\t\t});\n\t}\n\n\tprivate syncTable(): void {\n\t\tthis.sequelize.sync().then(() => {\n\t\t\tthis.User.create({\n\t\t\t\tfirstName: 'Test',\n\t\t\t\tlastName: 'Tester',\n\t\t\t\temail: 'test@tester.com',\n\t\t\t\trole: 'admin'\n\t\t\t\t})\n\t\t})\n\t}\n\n\tpublic getUser(payload): Promise<UserAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.User.findById(payload.id)\n\t\t\t\t.then((userInstance: UserInstance) => {\n\t\t\t\tconsole.log('user ', userInstance);\n\t\t\t\t\tresolve(userInstance);\n\t\t\t\t\treject('error with find ID');\n\t\t\t\t});\n\t\t});\n\t}\n\n\tpublic setUserProps(payload): Promise<UserAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.User.findById(payload.id)\n\t\t\t\t.then(userInstance => {\n\t\t\t\t\tuserInstance.update(payload.props)\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t\tconsole.log('user set', response);\n\t\t\t\t\t}, error => {\n\t\t\t\t\t\treject('update error with' + error);\n\t\t\t\t}).catch(error => console.log(error));\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic createTestUser(): Promise<UserAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.sequelize.sync().then(instance => {\n\t\t\treturn instance.User.create({\n\t\t\t\t\temail: 'test@tester.com',\n\t\t\t\t\trole: 'general'\n\t\t\t})\n\t\t\t}).then(userInstance =>{\n\t\t\t\tresolve(userInstance);\n\t\t\t\treject('error with test user');\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic getCompany(payload: any): Promise<CompanyAttributes[]> {\n\t\tif (payload) {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.Company.findById(payload.id)\n\t\t\t\t\t.then((companiesInstance: CompanyInstance) => {\n\t\t\t\t\t\tresolve(companiesInstance);\n\t\t\t\t\t\treject('error with find ID');\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic getCompanies(): Promise<CompanyAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Company.findAll({\n\t\t\t\tinclude: [this.Contact, this.Quote, ]\n\t\t\t})\n\t\t\t\t.then((companies: CompanyInstance[])=> {\n\t\t\t\t\tresolve(companies);\n\t\t\t\t\treject('error: no companies found');\n\t\t\t\t});\n\t\t});\n\t}\n\n\tpublic setCompanyProp(payload): Promise<CompanyAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Company.findById(payload.id)\n\t\t\t\t.then((companyInstance: CompanyInstance) => {\n\t\t\t\t\t\tcompanyInstance.update({[payload.prop.key]: payload.prop.value})\n\t\t\t\t\t\t\t.then((updatedCompanyInstance: CompanyInstance) => {\n\t\t\t\t\t\t\t\tresolve(updatedCompanyInstance);\n\t\t\t\t\t\t}).catch(err => console.log('ERROR : setCompanyProp', err))\n\t\t\t}, error => reject('Company set prop error :' + error))\n\t\t})\n\t}\n\n\tpublic setCompanyProps(payload): Promise<CompanyAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Company.findById(payload.id)\n\t\t\t\t.then((companyInstance: CompanyInstance) => {\n\t\t\t\t\t\tcompanyInstance.update(payload.props)\n\t\t\t\t\t\t\t.then((updatedCompanyInstance: CompanyInstance) => {\n\t\t\t\t\t\t\t\tresolve(updatedCompanyInstance);\n\t\t\t\t\t\t}).catch(err => console.log('ERROR : setCompanyProp', err))\n\t\t\t}, error => reject('Company set prop error :' + error))\n\t\t})\n\t}\n\n\tpublic createCompany(payload: any): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Company.create(payload.props, {\n\t\t\t\tinclude: [this.Quote, this.Contact]\n\t\t\t}).then((companyInstance: CompanyInstance) => {\n\t\t\t\tresolve(companyInstance);\n\t\t\t}, error => {\n\t\t\t\treject('update error with' + error);\n\t\t\t});\n\t\t})\n\t}\n\n\tpublic deleteCompany(payload: any): Promise<any> {\n\t\tconsole.log('payload', payload);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Company.destroy({where: {id: payload.id}}).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t}, error => {\n\t\t\t\treject('update error with' + error);\n\t\t\t});\n\t\t})\n\t}\n\n\n\tpublic deleteContact(payload: any): Promise<any> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.Contact.destroy({where: {id: payload.id}}).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic getContact(payload: any): Promise<ContactAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Contact.findById(payload.id, {include: [this.Note]})\n\t\t\t\t.then((contactsInstance: ContactInstance) => {\n\t\t\t\tconsole.log('Contact instance ',contactsInstance);\n\t\t\t\tresolve(contactsInstance);\n\t\t\t\treject('error with find ID');\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic getContacts(payload): Promise<ContactAttributes[]> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(payload.owner_id){\n\t\t\t\tthis.Contact.findAll({where: {company_id: payload.owner_id}, include: [this.Note]})\n\t\t\t\t\t.then((contactsInstance: ContactInstance[]) => {\n\t\t\t\t\t\tconsole.log('CONTACTS INSTANCE', contactsInstance);\n\t\t\t\t\t\tresolve(contactsInstance);\n\t\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.Contact.findAll({include: [this.Note]})\n\t\t\t\t\t.then((contactsInstance: ContactInstance[]) => {\n\t\t\t\t\tconsole.log('CONTACTS INSTANCE', contactsInstance);\n\t\t\t\t\tresolve(contactsInstance);\n\t\t\t\t}, error => reject('error finding Contacts: ' + error));\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic setContactProps(payload): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Contact.findById(payload.id)\n\t\t\t\t.then((contactInstance: ContactInstance) => {\n\t\t\t\t\tcontactInstance.update(payload.props)\n\t\t\t\t\t\t.then((instance: ContactInstance) => {\n\t\t\t\t\t\t\tresolve(instance);\n\t\t\t\t\t})\n\t\t\t}, error => {\n\t\t\t\treject('update error with: ' + error);\n\t\t\t});\n\t\t})\n\t}\n\n\tpublic createContact(payload: any): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst props = Object.assign({}, payload.props, {company_id: payload.owner_id});\n\t\t\tthis.Contact.create(props).then((instance: any) => {\n\t\t\t\tresolve(instance);\n\t\t\t}, error => {\n\t\t\t\t\treject('update error with' + error);\n\t\t\t\t});\n\t\t\t})\n\t}\n\n\tpublic getNote(payload): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Note.findById(payload.id).then((notes: NoteInstance)=> {\n\t\t\t\tresolve(notes);\n\t\t\t\treject('error: no notes found');\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic getNotes(payload): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Note.findAll({where: {contact_id: payload.owner_id}})\n\t\t\t\t.then((notes: NoteInstance[])=> {\n\t\t\t\t\tresolve(notes);\n\t\t\t\t\treject('error: no notes found');\n\t\t\t\t});\n\t\t});\n\t}\n\n\tpublic setNoteProp(payload): Promise<NoteAttributes> {\n\t\tconsole.log('notes payload',payload);\n\t\treturn new Promise((resolve) => {\n\t\t\t\tthis.Note.findById(payload.id).then(noteInstance => {\n\t\t\t\t\tnoteInstance.update({[payload.prop.key]: payload.prop.value})\n\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\tconsole.log('updated note with resposne: ', response);\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tpublic createNote(payload: any): Promise<any> {\n\t\tconst props = Object.assign({}, {contact_id: payload.owner_id});\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Note.create(props).then((instance: any) => {\n\t\t\t\t\tresolve(instance);\n\t\t\t\t}, error => {\n\t\t\t\t\treject('update error with' + error);\n\t\t\t\t});\n\t\t})\n\t}\n\n\tpublic destroyNote(payload): Promise<any> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.Note.destroy({where: {id: payload.id}}).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t})\n\t\t})\n\t}\n\tpublic getQuote(payload: any): Promise<QuoteAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Quote.findById(payload.id,{\n\t\t\t\tinclude: [\n\t\t\t\t\tthis.QuoteLine\n\t\t\t\t]\n\t\t\t}).then((quotesInstance: QuoteInstance) => {\n\t\t\t\tresolve(quotesInstance);\n\t\t\t}, error => reject('error with find ID'));\n\t\t});\n\t}\n\tpublic getQuotes(payload): Promise<QuoteAttributes[]> {\n\t\tif(payload.owner_id){\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.Quote.findAll({\n\t\t\t\t\tinclude: [\n\t\t\t\t\t\tthis.QuoteLine\n\t\t\t\t\t],\n\t\t\t\t\twhere: {\n\t\t\t\t\t\tcompany_id: payload.owner_id\n\t\t\t\t\t}\n\t\t\t\t}).then((quotesInstance: QuoteInstance[]) => {\n\t\t\t\t\tresolve(quotesInstance);\n\t\t\t\t}, error => reject('error with find ID'));\n\t\t\t});\n\t\t} else {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.Quote.findAll({\n\t\t\t\t\tinclude:\n\t\t\t\t\t\t[this.QuoteLine]\n\t\t\t\t}).then((quotesInstance: QuoteInstance[]) => {\n\t\t\t\t\tresolve(quotesInstance);\n\t\t\t\t}, error => reject('error with find ID'));\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic setQuoteProps(payload: any): Promise<QuoteAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Quote.update(payload.props, {\n\t\t\t\twhere:\n\t\t\t\t\t{id: payload.id}\n\t\t\t}).then((response: any) => {\n\t\t\t\tif(+response[0] === 1)\n\t\t\t\tthis.Quote.findById(payload.id, {\n\t\t\t\t\tinclude: [this.QuoteLine]\n\t\t\t\t})\n\t\t\t\t\t.then((quoteInstance_find:QuoteInstance) => {\n\t\t\t\t\t\tresolve(quoteInstance_find)\n\t\t\t\t\t})\n\t\t\t}, error => {\n\t\t\t\treject('update error with' + error);\n\t\t\t});\n\t\t})\n\t}\n\n\tpublic setQuoteLineProps(payload: any): Promise<QuoteAttributes> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.QuoteLine.update(payload.props, {where: {id: payload.id}})\n\t\t\t\t.then((response: any) => {\n\t\t\t\t\tresolve(response)\n\t\t\t\t})\n\t\t});\n\t}\n\n\tpublic createQuote(payload: any): Promise<QuoteAttributes> {\n\t\tconst props = Object.assign({}, payload.props, {company_id: payload.owner_id});\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.Quote.create(props).then((instance: any) => {\n\t\t\t\t\tresolve(instance);\n\t\t\t\t}, error => {\n\t\t\t\t\treject('update error with' + error);\n\t\t\t\t});\n\t\t\t})\n\t}\n\n\tpublic createQuoteLine(payload): Promise<any> {\n\t\tconst props = _.merge({}, payload.props, {quote_id: payload.owner_id});\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.QuoteLine.create(props).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t});\n\t\t})\n\t}\n\n\tpublic destroyQuote(payload): Promise<any> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.Quote.destroy({where: {id: payload.id}}).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic destroyQuoteLine (payload): Promise<any> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.QuoteLine.destroy({where: {id: payload.id}}).then(res => {\n\t\t\t\tresolve(res);\n\t\t\t})\n\t\t})\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/orm/store-manager.ts","export function companyModel(DataTypes, sequlize) {\n\treturn sequlize.define('company', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tname: {\n\t\t\ttype: DataTypes.STRING,\n\t\t\t// required: true\n\t\t},\n\t\taddressOne: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\taddressTwo: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tcity: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tzip: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tphone: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tweb: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tfax: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tmisc: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at: DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/company.table-model.ts","export function contactModel(DataTypes, sequlize) {\n\treturn sequlize.define('contact', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tname: {\n\t\t\ttype: DataTypes.STRING\n\t\t\t// required: true\n\t\t},\n\t\tphone: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\temail: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tposition: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at: DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/contact.table-model.ts","export function noteModel(DataTypes, sequlize) {\n\treturn sequlize.define('note', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tname: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\ttext: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at: DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/note.table-model.ts","export function quoteLineModel(DataTypes, sequlize) {\n\treturn sequlize.define('quoteLine', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tname: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tweight: {\n\t\t\ttype: DataTypes.DOUBLE\n\t\t},\n\t\tisCentered: {\n\t\t\ttype: DataTypes.BOOLEAN\n\t\t},\n\t\tunit: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tcost: {\n\t\t\ttype: DataTypes.FLOAT\n\t\t},\n\t\tdesc: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at:  DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/quote-line.table-model.ts","export function quoteModel(DataTypes, sequlize) {\n\treturn sequlize.define('quote', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tname: {\n\t\t\ttype: DataTypes.STRING,\n\t\t\t// required: true\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at:  DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true,\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/quote.table-model.ts","export function userModel(DataTypes, sequlize) {\n\treturn sequlize.define('user', {\n\t\tid: {\n\t\t\ttype: DataTypes.UUID,\n\t\t\tprimaryKey: true,\n\t\t\tdefaultValue: DataTypes.UUIDV4\n\t\t},\n\t\tfirstName: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tlastName: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\tpassHash: {\n\t\t\ttype: DataTypes.STRING,\n\t\t},\n\t\trole: {\n\t\t\ttype: DataTypes.ENUM,\n\t\t\tvalues: ['general', 'blocked', 'admin', 'removed'],\n\t\t\trequired: true\n\t\t},\n\t\temail: {\n\t\t\ttype: DataTypes.STRING,\n\t\t\trequired: true\n\t\t},\n\t\taddressOne: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\taddressTwo: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tphone: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tbusinessName: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tbusinessWeb: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tbusinessPhone: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tbusinessFax: {\n\t\t\ttype: DataTypes.STRING\n\t\t},\n\t\tcreated_at: {\n\t\t\ttype: DataTypes.DATE,\n\t\t\tallowNull: false\n\t\t},\n\t\tupdated_at: DataTypes.DATE,\n\t\tdeleted_at: DataTypes.DATE\n\t}, {\n\t\tfreezeTableName: true,\n\t\tparanoid: false,\n\t\tunderscored: true,\n\t})\n}\n\n\n// WEBPACK FOOTER //\n// ./src/orm/table-models/user.table-model.ts","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"sendgrid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sendgrid\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 18\n// module chunks = 0"],"sourceRoot":""}